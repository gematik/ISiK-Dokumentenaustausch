{
  "resourceType": "OperationDefinition",
  "id": "SubmitDocument",
  "status": "draft",
  "experimental": false,
  "version": "2.0.0",
  "publisher": "gematik GmbH",
  "date": "2021-11-12",
  "url": "https://gematik.de/fhir/ISiK/v2/OperationDefinition/SubmitDocument",
  "title": "Submission of new document",
  "kind": "operation",
  "name": "submit-document",
  "description": "Submit document metadata and payload to a server for storage/persistence.",
  "purpose": "Using Operations instead of transaction Bundles allows for refined server side \r\n    logic beyond create/update to occur and simplifies client control",
  "code": "submit-document",
  "comment": "\r\n    Expected behaviour:\r\n\r\n* Servers SHALL store the submitted binary with the associated metadata and make it available through the FHIR API\r\n* If the submission contains a structured FHIR document-Bundle, Servers MAY chose to store additional representations of the document,\r\ne.g. native FHIR (XML and/or JSON) for FHIR aware Clients and/or HTML to allow easy read access for FHIR agnostic Clients. \r\nThe Binary representation mostly serves the purpose of Archiving an immutable version of the document, rather than making it available to other consumers!\r\nIf Servers can provide multiple representations of the same documente, this SHOULD be reflected in multiple `content`-elements in the DocumentReference\r\n* Servers SHALL return HTTP 412 (precondifion failed) if the DocumentReference.identifier is not unique on the server (already associated with another document)\r\n* If a Client submits a DocumentReference which includes a `relatesTo`-Element, the Server SHALL process the submission in accordance with `relatesTo.code` as either a \r\nreplacement, transformation, appendix or a signature of the document referenced in `relatesTo.target`. If the submission is successful, Servers SHALL update \r\nthe `status` of the related DocumentReference to `superseded`. \r\n* Servers SHALL return HTTP 412 (precondition failed) the `relatesTo.target` reference does not resolve on the server.\r\n* Servers SHALL ignore any information submitted by the Client in `DocumentReference.content` and assume the content to be the Binary submitted with the `payload`parameter.\r\n* Servers SHALL set the `content`-element to reflect how and where the document has been stored by the server.\r\n",
  "system": true,
  "type": false,
  "instance": false,
  "inputProfile": "https://gematik.de/fhir/ISiK/v2/StructureDefinition/SubmitDocumentInput",
  "outputProfile": "https://gematik.de/fhir/ISiK/v2/StructureDefinition/SubmitDocumentOutput",
  "parameter": [
    {
      "name": "metadata",
      "use": "in",
      "min": 1,
      "max": "1",
      "documentation": "DocumentReference containing document metadata",
      "type": "DocumentReference"
    },
    {
      "name": "payload",
      "use": "in",
      "min": 1,
      "max": "1",
      "documentation": "Binary containing document payload",
      "type": "Binary"
    },
    {
      "name": "output-metadata",
      "use": "out",
      "min": 1,
      "max": "1",
      "documentation": "DocumentReference as persisted by the server",
      "type": "DocumentReference"
    }
  ]
}
